% Training
clear all
load('trainingFeatures_meta.mat')
load('trainingLabels_meta.mat');
trainingFeatures_meta = trainingFeatures_meta;
trainTarget = grp2idx(trainingLabels_meta);
T = TargetCreation(trainTarget)
net = trainSoftmaxLayer(trainingFeatures_meta, T);


%% Testting
load('testFeatures_meta.mat');
load('testLabels_meta.mat');
testFeatures_meta = testFeatures_meta;
testTarget = grp2idx(testLabels_meta);
T = TargetCreation(testTarget);

Y = net(testFeatures_meta);
[~,y] = max(Y);
[~,t] = max(T);
confusion.getMatrix(t,y)


confusionchart(y,t);
